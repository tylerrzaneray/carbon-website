{
    "componentChunkName": "component---src-pages-developing-vue-tutorial-step-3-mdx",
    "path": "/developing/vue-tutorial/step-3/",
    "result": {"pageContext":{"frontmatter":{"title":"3. Using APIs","description":"Welcome to Carbon! This tutorial will guide you in creating a Vue app with the Carbon Design System.","internal":false,"tabs":["Overview","Step 1","Step 2","Step 3","Step 4","Step 5","Wrapping up"]},"relativePagePath":"/developing/vue-tutorial/step-3.mdx","titleType":"prepend","MdxNode":{"id":"622b0472-8d6f-583c-af88-f3162ea2489d","children":[],"parent":"08db83c7-2113-5b5b-8447-90feb2bc05ae","internal":{"content":"---\ntitle: 3. Using APIs\ndescription:\n  Welcome to Carbon! This tutorial will guide you in creating a Vue app with the\n  Carbon Design System.\ninternal: false\ntabs:\n  ['Overview', 'Step 1', 'Step 2', 'Step 3', 'Step 4', 'Step 5', 'Wrapping up']\n---\n\nimport Preview from 'components/Preview';\n\n<PageDescription>\n\nThis step takes our static components and populates them with data from the\nGitHub GraphQL API – loading states and all. We'll be displaying Carbon\nrepository information in a data table.\n\n</PageDescription>\n\n<AnchorLinks>\n\n<AnchorLink>Fork, clone and branch</AnchorLink>\n<AnchorLink>Install dependencies</AnchorLink>\n<AnchorLink>Create access token</AnchorLink>\n<AnchorLink>Connect to Apollo</AnchorLink>\n<AnchorLink>Fetch data</AnchorLink>\n<AnchorLink>Populate data table</AnchorLink>\n<AnchorLink>Add loading</AnchorLink>\n<AnchorLink>Add pagination</AnchorLink>\n<AnchorLink>Submit pull request</AnchorLink>\n\n</AnchorLinks>\n\n### Preview\n\nThe [GitHub GraphQL API](https://developer.github.com/v4/) is very well\ndocumented, and even though the focus of this tutorial isn't learning and using\nGraphQL, it's a great opportunity to fetch Carbon-related data for this Carbon\ntutorial.\n\nTo do so, we'll be using Apollo Client, the front-end component of the\n[Apollo Platform](https://www.apollographql.com/docs/intro/platform). Apollo\nprovides several open source tools for using GraphQL throughout your\napplication’s stack. Apollo Client is a sophisticated GraphQL client that\nmanages data and state in an application.\n\nA [preview](https://vue-step-4--carbon-tutorial-vue.netlify.com) of what you\nwill build (see repositories page):\n\n<Preview\n  height=\"400\"\n  title=\"Carbon Tutorial Step 3\"\n  src=\"https://vue-step-4--carbon-tutorial-vue.netlify.com\"\n  frameborder=\"no\"\n  allowtransparency=\"true\"\n  allowfullscreen=\"true\"\n/>\n\n## Fork, clone and branch\n\nThis tutorial has an accompanying GitHub repository called\n[carbon-tutorial-vue](https://github.com/carbon-design-system/carbon-tutorial-vue)\nthat we'll use as a starting point for each step. If you haven't forked and\ncloned that repository yet, and haven't added the upstream remote, go ahead and\ndo so by following the\n[step 2 instructions](/developing/vue-tutorial/step-1#fork-clone-and-branch).\n\n### Branch\n\nWith your repository all set up, let's check out the branch for this tutorial\nstep's starting point.\n\n```bash\ngit fetch upstream\ngit checkout -b vue-step-3 upstream/vue-step-3\n```\n\n### Build and start app\n\nInstall the app's dependencies:\n\n```bash\nyarn\n```\n\nThen, start the app:\n\n```bash\nyarn serve\n```\n\nYou should see something similar to where the\n[previous step](/developing/vue-tutorial/step-2) left off. Stop your app with\n`CTRL-C` and let's get everything installed.\n\n## Install dependencies\n\nWe'll shortcut this using the Vue CLI, if you'd like more information head over\nto\n[Vue Apollo Installation](https://vue-apollo.netlify.com/guide/installation.html#vue-cli-plugin)\nfor details.\n\n<InlineNotification>\n\n**Note:** If you have not yet installed the Vue CLI, you will need to\n[install the Vue CLI](https://cli.vuejs.org/) before running the Vue Apollo\nInstallation.\n\n</InlineNotification>\n\nInstall the following\n\n- `apollo-boost` - package containing everything you need to set up Apollo\n  Client\n- `graphql` - parses your GraphQL queries\n- `vue-apollo` - Apollo integration for Vue\n\nUsing the command:\n\n```bash\nvue add apollo\n```\n\nAt the following prompts answer 'No' to each of the questions.\n\n- Add example code? No\n- Add a GraphQL API Server? No\n- Configure Apollo Engine? No\n\n## Create access token\n\nYou'll need a personal access token from your GitHub account in order to make\nrequests to the GitHub API. Check out\n[this guide](https://help.github.com/en/articles/creating-a-personal-access-token-for-the-command-line)\nto see how to get one.\n\nWhen you get to the scope/permissions step, you can leave them all unchecked. We\ndon't need any special permissions, we just need access to the public API.\n\nOnce you have your token, we need to put it in a place where `create-vue-app`\ncan use it. When your application is being built and developed, create-vue-app\nwill parse environmental variables in any file that starts with `.env` and make\nthem available under `process.env.MY_VARIABLE`.\n\nOne caveat is that we need to start our variables with `VUE_APP_`. You can read\nmore about environmental variables in\n[create-vue-app's guide](https://cli.vuejs.org/guide/mode-and-env.html#environment-variables).\n\n<InlineNotification>\n\n**Note:** If you already have a valid GitHub Personal Access Token, you can use\nthat token here.\n\n</InlineNotification>\n\nSince we don't want to commit this file to Git, we can put it in `.env.local`\nwhich is in our `.gitignore` list. Your file should just have a single line like\nthis one, where the `x`s are replaced with your unique token.\n\n```bash path=.env.local\nVUE_APP_GITHUB_PERSONAL_ACCESS_TOKEN=xxxxxx\n```\n\nGo ahead and start your app with `yarn serve`, or, if your app is running,\nyou'll need to restart it to get access to this token.\n\n## Connect to Apollo\n\nThe `vue-apollo` plugin has made a number of changes to our project.\n\nIf you open `src/main.js` you will see that the CLI has updated this file with\nthe following:.\n\n```javascript path=src/main.js\nimport { createProvider } from 'vue-apollo';\n\nnew Vue({\n  router,\n  apolloProvider: createProvider(),\n  render: (h) => h(App),\n}).$mount('#app');\n```\n\nThis is loading from a file the CLI created for you `src/vue-apollo.js` which we\nneed to update to target the github api.\n\nUpdate the following values:\n\n```javascript path=src/vue-apollo.js\n// Use our access token\nconst AUTH_TOKEN = process.env.VUE_APP_GITHUB_PERSONAL_ACCESS_TOKEN;\n\n// Target github api\nconst httpEndpoint =\n  process.env.VUE_APP_GRAPHQL_HTTP || 'https://api.github.com/graphql';\n```\n\nUpdate only the `wsEndpoint` and `getAuth` properties of the `defaultOptions`\nobject:\n\n```javascript\nconst defaultOptions = {\n  // set wsEndpoint to null\n  wsEndpoint: process.env.VUE_APP_GRAPHQL_WS,\n\n  // Use the form expected by github for authorisation\n  getAuth: (tokenName) => `Bearer ${tokenName}`,\n};\n```\n\n## Fetch data\n\n### Imports\n\nAdd the following imports to the top of the script section of `RepoPage.vue`:\n\n```javascript path=src/views/RepoPage/RepoPage.vue\nimport gql from 'graphql-tag';\n```\n\n### Query\n\nNext we'll assemble our GraphQL query to fetch only the data we need from the\nGraphQL API. We'll do this using the `gql` helper we just imported. The `gql`\nhelper lets you write GraphQL queries using interpolated strings (backticks) in\nJavaScript. In addition, we'll be using the `Query` component from `vue-apollo`\nwhich gives us some great information about our query's loading state in\naddition to the data.\n\nYou can use GitHub's [explorer](https://developer.github.com/v4/explorer/) tool\nto write and test your own queries. Try copying the query below and experiment\nwith changing the properties. You can also click the \"Docs\" button in the top\nright of the explorer to view all of the available data and query parameters.\n\nIf you'd like some more information regarding writing queries and using the\nQuery component, we recommend\n[Apollo's documentation](https://www.apollographql.com/docs/tutorial/queries) on\nthis topic.\n\nAdd this after your imports:\n\n```graphql path=src/views/RepoPage/RepoPage.vue\nconst REPO_QUERY = gql`\n  query REPO_QUERY {\n    # Let's use carbon as our organization\n    organization(login: \"carbon-design-system\") {\n      # We'll grab all the repositories in one go. To load more resources\n      # continuously, see the advanced topics.\n      repositories(first: 75, orderBy: { field: UPDATED_AT, direction: DESC }) {\n        totalCount\n        nodes {\n          url\n          homepageUrl\n          issues(filterBy: { states: OPEN }) {\n            totalCount\n          }\n          stargazers {\n            totalCount\n          }\n          releases(first: 1) {\n            totalCount\n            nodes {\n              name\n            }\n          }\n          name\n          updatedAt\n          createdAt\n          description\n          id\n        }\n      }\n    }\n  }\n`;\n```\n\nNext, we need to configure apollo in our component script, adding the following\nafter the data() declaration.\n\n```javascript path=src/views/RepoPage/RepoPage.vue\napollo: {\n  organization: REPO_QUERY\n},\n```\n\nAt this point, we should run our query view the raw the results to verify that\nthe request is working.\n\nIn RepoPage.vue add the following before the `RepoTable` tag.\n\n```html path=src/views/RepoPage/RepoPage.vue\n{{ this.organization }}\n```\n\nWhen the data loads you should see the response rendered on your repository\npage. If not, check the console to see if there are any errors and fix.\n\nRevert this last change and continue.\n\nThis data is not quite in the format our `RepoTable` component is expecting so\nwe'll use a computed property to transform it. Computed properties in Vue cache\nand watch their reactive dependencies for us.\n\nRemove the 'rows' constant and its use in the data declaration, and add this\ncomputed property.\n\n```javascript path=src/views/RepoPage/RepoPage.vue\ncomputed: {\n  rows() {\n      if (!this.organization) {\n      return [];\n    } else {\n      return this.organization.repositories.nodes.map(row => ({\n        ...row,\n        key: row.id,\n        stars: row.stargazers.totalCount,\n        issueCount: row.issues.totalCount,\n        createdAt: new Date(row.createdAt).toLocaleDateString(),\n        updatedAt: new Date(row.updatedAt).toLocaleDateString(),\n        links: { url: row.url, homepageUrl: row.homepageUrl }\n      }));\n    }\n  }\n}\n```\n\nAt this point you have a working table but the links column clearly isn't what\nwe want.\n\n### Helper component\n\nThis column in the data table will be a list of repository and home page links,\nso let's create a component called `LinkList`.\n\nAdd the following to create your component:\n\nA template section:\n\n```html path=src/views/RepoPage/LinkList.vue\n<ul class=\"link-list\">\n  <li>\n    <cv-link :href=\"url\">GitHub</cv-link>\n  </li>\n\n  <li v-if=\"homepageUrl\">\n    <span>&nbsp;|&nbsp;</span>\n    <cv-link :href=\"homepageUrl\">Homepage</cv-link>\n  </li>\n</ul>\n```\n\nA script section:\n\n```javascript path=src/views/RepoPage/LinkList.vue\nexport default {\n  name: 'LinkList',\n  props: {\n    url: String,\n    homepageUrl: String,\n  },\n};\n```\n\nAnd a style section:\n\n```scss path=src/views/RepoPage/LinkList.vue\n.link-list {\n  display: flex;\n}\n```\n\nNow let's make use of this component in our `RepoTable` component.\n\nAt the top of the script section import the link list component:\n\n```javascript path=src/views/RepoPage/RepoTable.vue\nimport LinkList from './LinkList';\n```\n\nAnd below the name of the component add:\n\n```javascript path=src/views/RepoPage/RepoTable.vue\n  components: { LinkList },\n```\n\nThen make use of it in our template replacing:\n\n<!-- prettier-ignore-start -->\n```html path=src/views/RepoPage/RepoTable.vue\n<cv-data-table-cell\n  v-for=\"(cell, cellIndex) in row.data\"\n  :key=\"`${cellIndex}`\"\n  >{{cell}}</cv-data-table-cell>\n```\n<!-- prettier-ignore-end -->\n\nwith\n\n<!-- prettier-ignore-start -->\n```html path=src/views/RepoPage/RepoTable.vue\n<cv-data-table-cell v-for=\"(cell, cellIndex) in row.data\" :key=\"`${cellIndex}`\">\n  <template v-if=\"!cell.url\">\n    {{cell}}\n  </template>\n  <link-list v-else :url=\"cell.url\" :homepage-url=\"cell.homepageUrl\" />\n</cv-data-table-cell>\n```\n<!-- prettier-ignore-end -->\n\nHere in order to switch between the standard rendering of a data cell we've\nwrapped our standard `{{cell}}` rendering in a template tag. The template tag is\nnon-rendering so it will disappear, leaving us with the same content as before.\n\nUsing the v-if and v-else directives we switch based on the contents of the cell\nbetween the standard rendering and the LinkList component.\n\nChecking our output again, you should now see the LinkList component rendering\nthe final column.\n\nNext we'll update our row description. Update the computed property data() in\n`RepoTable.vue` to have the following description:\n\n<!-- prettier-ignore-start -->\n```javascript path=src/views/RepoPage/RepoTable.vue\n  description: row.description\n```\n<!-- prettier-ignore-end -->\n\nCheck the output again and you should find the descriptions are updated.\n\nAfter this many refreshes you may have noticed a slight delay in the data\nloading. As outlined in the\n[documentation](https://vue-apollo.netlify.com/guide/apollo/#apollo), all\ncomponents contained under one with an apolloProvider have a `$apollo`\nattribute. As we added the `apolloProvider` to our app when creating the Vue\ninstance it is available to us everywhere.\n\nWe can use the property to react to\n[loading state](https://vue-apollo.netlify.com/guide/apollo/queries.html#loading-state).\n\nFirst let's demonstrate that this works.\n\nPass the loading state into our `RepoTable` component by updating the template\nwith the following:\n\n```html path=src/views/RepoPage/RepoPage.vue\n<repo-table\n  :headers=\"headers\"\n  :rows=\"rows\"\n  title=\"Carbon Repositories\"\n  helperText=\"A collection of public Carbon repositories.\"\n  :loading=\"$apollo.loading\"\n/>\n```\n\nNext add this property to the `RepoTable` component:\n\n```javascript path=src/views/RepoPage/RepoTable.vue\n  props: {\n    headers: Array,\n    rows: Array,\n    title: String,\n    helperText: String,\n    loading: Boolean,\n  },\n```\n\nMaking use of the property to display a loading message.\n\nReplace:\n\n```html path=src/views/RepoPage/RepoTable.vue\n<cv-data-table\n  :columns=\"columns\"\n  :title=\"title\"\n  :helper-text=\"helperText\"\n></cv-data-table>\n```\n\nwith:\n\n```html path=src/views/RepoPage/RepoTable.vue\n<div v-if=\"loading\">Loading...</div>\n<cv-data-table\n  v-else\n  :columns=\"columns\"\n  :title=\"title\"\n  :helper-text=\"helperText\"\n></cv-data-table>\n```\n\nHere we have made use of the v-if and v-else directives to switch content based\non the state of `$apollo.loading`. If you refresh your app you should see this\ntake effect.\n\nNow that we know this is works let's try something a bit more sophisticated and\nreplace the div containing our loading message with use of the\n`CvDataTableSkeleton` component.\n\n<!-- prettier-ignore-start -->\n```html path=src/views/RepoPage/RepoTable.vue\n<cv-data-table-skeleton\n  v-if=\"loading\"\n  :columns=\"columns\"\n  :title=\"title\"\n  :helper-text=\"helperText\"\n  :rows=\"10\"\n/>\n```\n<!-- prettier-ignore-end -->\n\nWe need to tell the loading skeleton how many rows to render, so let's use 10\nskeleton rows to prepare for the next enhancement...\n\n## Add pagination\n\nPagination! Instead of rendering every repository, let's add pagination to the\ndata table to only render 10 at a time. Depending on your specific requirements,\nyou may need to fetch new data each time that you interact with the pagination\ncomponent, but for simplicity, we're going to make one request to fetch all\ndata, and then paginate the in-memory row data.\n\nLet's start by adjusting our `PageTable` component template to add pagination.\nIf you review the\n[storybook notes](http://vue.carbondesignsystem.com/?path=/info/components-cvdatatable--default)\nyou'll see that pagination is added to the data table by supplying a pagination\nobject and listening for pagination events as follows.\n\n<!-- prettier-ignore-start -->\n```html path=src/views/RepoPage/RepoTable.vue\n  <cv-data-table\n    v-else\n    :columns=\"columns\"\n    :title=\"title\"\n    :helper-text=\"helperText\"\n    :pagination=\"{ numberOfItems: this.totalRows }\"\n    @pagination=\"$emit('pagination', $event)\"\n>\n```\n<!-- prettier-ignore-end -->\n\n<InlineNotification>\n\n**Note:** `:prop` is an abbreviation of `v-bind:prop`. `@event` is an\nabbreviation of `v-on:event`.\n\n</InlineNotification>\n\nIn the pagination event we've used $emit and $event to re-raise the pagination\nevent to our `RepoPage` component so that it can arrange to pass only the rows\nwe want to see to the `RepoTable` component.\n\nWe also need to add the `totalRows` property used in the data tables pagination\nproperty.\n\n```javascript path=src/views/RepoPage/RepoTable.vue\ntotalRows: Number,\n```\n\nNext to our `RepoPage` component, let's first update our template by updating\nour `RepoTable` use with the following attributes.\n\n<!-- prettier-ignore-start -->\n```html path=src/views/RepoPage/RepoPage.vue\n:rows=\"pagedRows\"\n:totalRows=\"rows.length\"\n@pagination=\"onPagination\"\n```\n<!-- prettier-ignore-end -->\n\nreplacing\n\n```html path=src/views/RepoPage/RepoPage.vue\n:rows=\"rows\"\n```\n\nNext in the data property of our component add values for `pageSize`,\n`pageStart` and `page` into the data method return to support our pagination.\n\n```javascript path=src/views/RepoPage/RepoPage.vue\n  data() {\n    return {\n      headers,\n      pageSize: 0,\n      pageStart: 0,\n      page: 0\n    };\n  },\n```\n\n<InlineNotification>\n\n**Note:** We could have passed values for `pageSize` and `page` into our\npagination component if we had a specific page or page size we wanted to start\nwith. Instead we are relying on the pagination component to set some sensible\ndefaults and provide us with the details through an event.\n\n</InlineNotification>\n\nThen before we can see our paginated table we need to add: a `pagedRows`\ncomputed property to select the slice of input rows we are interested in, and a\nmethod to handle the pagination event.\n\n```javascript path=src/views/RepoPage/RepoPage.vue\n  computed: {\n    // other computed properties\n    // ...\n    pagedRows() {\n      return this.rows.slice(this.pageStart, this.pageStart + this.pageSize);\n    }\n  },\n  methods: {\n    onPagination(val) {\n      this.pageSize = val.length;\n      this.pageStart = val.start;\n      this.page = val.page;\n    }\n  }\n```\n\n<InlineNotification>\n\n**Note:** Like the other Carbon Vue components, `Pagination` component examples\ncan be found in\n[Storybook](http://vue.carbondesignsystem.com/?path=/story/components-cvpagination--default)\nby browsing the story and knobs.\n\n</InlineNotification>\n\nThat does it! Your data table should fetch GitHub data on first render. You can\nexpand each row to see the repository's description. You can modify the\npagination items per page and cycle through pages or jump to a specific page of\nrepositories.\n\n## Mystery\n\nHmmm, there is at least one more issue to resolve. If you expand a row or two to\nsee the repository descriptions you will and then change page. What happens?\n\nAssuming you didn't catch this earlier you will find that the expanded rows,\nstay expanded after paging. That is if row two was expanded before pagination it\nis expanded after.\n\nThis is because we chose poor values to use as our row and cell keys as we\niterated over them. The result is that Vue sees these items as having the same\nkey and makes the assumption that content but not state has changed.\n\nTo fix this add the following to the RepoPage component you should be able to\nfind something better.\n\n```javascript\n  watch: {\n    rows() {\n      if (this.organization) {\n        console.dir(this.organization.repositories.nodes);\n      }\n    }\n  },\n```\n\n_Hint: `id` and `url` are likely unique properties, you could use either of\nthese to update the prototype. In fact we already pass the id value to\nRepoTable._\n\nCan you fix it?\n\n## Submit pull request\n\nWe're going to submit a pull request to verify completion of this tutorial step.\n\n### Continuous integration (CI) check\n\nRun the CI check to make sure we're all set to submit a pull request.\n\n```bash\nyarn ci-check\n```\n\n<InlineNotification>\n\n**Note:** Having issues running the CI check?\n[Step 1](/developing/vue-tutorial/step-1#continuous-integration-ci-check) has\ntroubleshooting notes that may help.\n\n</InlineNotification>\n\n### Git commit and push\n\nBefore we can create a pull request, stage and commit all of your changes:\n\n```bash\ngit add --all && git commit -m \"feat(tutorial): complete step 3\"\n```\n\nThen, push to your repository:\n\n```bash\ngit push origin vue-step-3\n```\n\n<InlineNotification>\n\n**Note:** Having issues pushing your changes?\n[Step 1](/developing/vue-tutorial/step-1#git-commit-and-push) has\ntroubleshooting notes that may help.\n\n</InlineNotification>\n\n### Pull request (PR)\n\nFinally, visit\n[carbon-tutorial-vue](https://github.com/carbon-design-system/carbon-tutorial-vue)\nto \"Compare & pull request\". In doing so, make sure that you are comparing to\n`vue-step-3` into `base: vue-step-3`.\n\n<InlineNotification>\n\n**Note:** Expect your tutorial step PRs to be reviewed by the Carbon team but\nnot merged. We'll close your PR so we can keep the repository's remote branches\npristine and ready for the next person!\n\n</InlineNotification>\n","type":"Mdx","contentDigest":"f2e31a5afe485a7dd8d5267a65bf668c","owner":"gatsby-plugin-mdx","counter":4048},"frontmatter":{"title":"3. Using APIs","description":"Welcome to Carbon! This tutorial will guide you in creating a Vue app with the Carbon Design System.","internal":false,"tabs":["Overview","Step 1","Step 2","Step 3","Step 4","Step 5","Wrapping up"]},"exports":{},"rawBody":"---\ntitle: 3. Using APIs\ndescription:\n  Welcome to Carbon! This tutorial will guide you in creating a Vue app with the\n  Carbon Design System.\ninternal: false\ntabs:\n  ['Overview', 'Step 1', 'Step 2', 'Step 3', 'Step 4', 'Step 5', 'Wrapping up']\n---\n\nimport Preview from 'components/Preview';\n\n<PageDescription>\n\nThis step takes our static components and populates them with data from the\nGitHub GraphQL API – loading states and all. We'll be displaying Carbon\nrepository information in a data table.\n\n</PageDescription>\n\n<AnchorLinks>\n\n<AnchorLink>Fork, clone and branch</AnchorLink>\n<AnchorLink>Install dependencies</AnchorLink>\n<AnchorLink>Create access token</AnchorLink>\n<AnchorLink>Connect to Apollo</AnchorLink>\n<AnchorLink>Fetch data</AnchorLink>\n<AnchorLink>Populate data table</AnchorLink>\n<AnchorLink>Add loading</AnchorLink>\n<AnchorLink>Add pagination</AnchorLink>\n<AnchorLink>Submit pull request</AnchorLink>\n\n</AnchorLinks>\n\n### Preview\n\nThe [GitHub GraphQL API](https://developer.github.com/v4/) is very well\ndocumented, and even though the focus of this tutorial isn't learning and using\nGraphQL, it's a great opportunity to fetch Carbon-related data for this Carbon\ntutorial.\n\nTo do so, we'll be using Apollo Client, the front-end component of the\n[Apollo Platform](https://www.apollographql.com/docs/intro/platform). Apollo\nprovides several open source tools for using GraphQL throughout your\napplication’s stack. Apollo Client is a sophisticated GraphQL client that\nmanages data and state in an application.\n\nA [preview](https://vue-step-4--carbon-tutorial-vue.netlify.com) of what you\nwill build (see repositories page):\n\n<Preview\n  height=\"400\"\n  title=\"Carbon Tutorial Step 3\"\n  src=\"https://vue-step-4--carbon-tutorial-vue.netlify.com\"\n  frameborder=\"no\"\n  allowtransparency=\"true\"\n  allowfullscreen=\"true\"\n/>\n\n## Fork, clone and branch\n\nThis tutorial has an accompanying GitHub repository called\n[carbon-tutorial-vue](https://github.com/carbon-design-system/carbon-tutorial-vue)\nthat we'll use as a starting point for each step. If you haven't forked and\ncloned that repository yet, and haven't added the upstream remote, go ahead and\ndo so by following the\n[step 2 instructions](/developing/vue-tutorial/step-1#fork-clone-and-branch).\n\n### Branch\n\nWith your repository all set up, let's check out the branch for this tutorial\nstep's starting point.\n\n```bash\ngit fetch upstream\ngit checkout -b vue-step-3 upstream/vue-step-3\n```\n\n### Build and start app\n\nInstall the app's dependencies:\n\n```bash\nyarn\n```\n\nThen, start the app:\n\n```bash\nyarn serve\n```\n\nYou should see something similar to where the\n[previous step](/developing/vue-tutorial/step-2) left off. Stop your app with\n`CTRL-C` and let's get everything installed.\n\n## Install dependencies\n\nWe'll shortcut this using the Vue CLI, if you'd like more information head over\nto\n[Vue Apollo Installation](https://vue-apollo.netlify.com/guide/installation.html#vue-cli-plugin)\nfor details.\n\n<InlineNotification>\n\n**Note:** If you have not yet installed the Vue CLI, you will need to\n[install the Vue CLI](https://cli.vuejs.org/) before running the Vue Apollo\nInstallation.\n\n</InlineNotification>\n\nInstall the following\n\n- `apollo-boost` - package containing everything you need to set up Apollo\n  Client\n- `graphql` - parses your GraphQL queries\n- `vue-apollo` - Apollo integration for Vue\n\nUsing the command:\n\n```bash\nvue add apollo\n```\n\nAt the following prompts answer 'No' to each of the questions.\n\n- Add example code? No\n- Add a GraphQL API Server? No\n- Configure Apollo Engine? No\n\n## Create access token\n\nYou'll need a personal access token from your GitHub account in order to make\nrequests to the GitHub API. Check out\n[this guide](https://help.github.com/en/articles/creating-a-personal-access-token-for-the-command-line)\nto see how to get one.\n\nWhen you get to the scope/permissions step, you can leave them all unchecked. We\ndon't need any special permissions, we just need access to the public API.\n\nOnce you have your token, we need to put it in a place where `create-vue-app`\ncan use it. When your application is being built and developed, create-vue-app\nwill parse environmental variables in any file that starts with `.env` and make\nthem available under `process.env.MY_VARIABLE`.\n\nOne caveat is that we need to start our variables with `VUE_APP_`. You can read\nmore about environmental variables in\n[create-vue-app's guide](https://cli.vuejs.org/guide/mode-and-env.html#environment-variables).\n\n<InlineNotification>\n\n**Note:** If you already have a valid GitHub Personal Access Token, you can use\nthat token here.\n\n</InlineNotification>\n\nSince we don't want to commit this file to Git, we can put it in `.env.local`\nwhich is in our `.gitignore` list. Your file should just have a single line like\nthis one, where the `x`s are replaced with your unique token.\n\n```bash path=.env.local\nVUE_APP_GITHUB_PERSONAL_ACCESS_TOKEN=xxxxxx\n```\n\nGo ahead and start your app with `yarn serve`, or, if your app is running,\nyou'll need to restart it to get access to this token.\n\n## Connect to Apollo\n\nThe `vue-apollo` plugin has made a number of changes to our project.\n\nIf you open `src/main.js` you will see that the CLI has updated this file with\nthe following:.\n\n```javascript path=src/main.js\nimport { createProvider } from 'vue-apollo';\n\nnew Vue({\n  router,\n  apolloProvider: createProvider(),\n  render: (h) => h(App),\n}).$mount('#app');\n```\n\nThis is loading from a file the CLI created for you `src/vue-apollo.js` which we\nneed to update to target the github api.\n\nUpdate the following values:\n\n```javascript path=src/vue-apollo.js\n// Use our access token\nconst AUTH_TOKEN = process.env.VUE_APP_GITHUB_PERSONAL_ACCESS_TOKEN;\n\n// Target github api\nconst httpEndpoint =\n  process.env.VUE_APP_GRAPHQL_HTTP || 'https://api.github.com/graphql';\n```\n\nUpdate only the `wsEndpoint` and `getAuth` properties of the `defaultOptions`\nobject:\n\n```javascript\nconst defaultOptions = {\n  // set wsEndpoint to null\n  wsEndpoint: process.env.VUE_APP_GRAPHQL_WS,\n\n  // Use the form expected by github for authorisation\n  getAuth: (tokenName) => `Bearer ${tokenName}`,\n};\n```\n\n## Fetch data\n\n### Imports\n\nAdd the following imports to the top of the script section of `RepoPage.vue`:\n\n```javascript path=src/views/RepoPage/RepoPage.vue\nimport gql from 'graphql-tag';\n```\n\n### Query\n\nNext we'll assemble our GraphQL query to fetch only the data we need from the\nGraphQL API. We'll do this using the `gql` helper we just imported. The `gql`\nhelper lets you write GraphQL queries using interpolated strings (backticks) in\nJavaScript. In addition, we'll be using the `Query` component from `vue-apollo`\nwhich gives us some great information about our query's loading state in\naddition to the data.\n\nYou can use GitHub's [explorer](https://developer.github.com/v4/explorer/) tool\nto write and test your own queries. Try copying the query below and experiment\nwith changing the properties. You can also click the \"Docs\" button in the top\nright of the explorer to view all of the available data and query parameters.\n\nIf you'd like some more information regarding writing queries and using the\nQuery component, we recommend\n[Apollo's documentation](https://www.apollographql.com/docs/tutorial/queries) on\nthis topic.\n\nAdd this after your imports:\n\n```graphql path=src/views/RepoPage/RepoPage.vue\nconst REPO_QUERY = gql`\n  query REPO_QUERY {\n    # Let's use carbon as our organization\n    organization(login: \"carbon-design-system\") {\n      # We'll grab all the repositories in one go. To load more resources\n      # continuously, see the advanced topics.\n      repositories(first: 75, orderBy: { field: UPDATED_AT, direction: DESC }) {\n        totalCount\n        nodes {\n          url\n          homepageUrl\n          issues(filterBy: { states: OPEN }) {\n            totalCount\n          }\n          stargazers {\n            totalCount\n          }\n          releases(first: 1) {\n            totalCount\n            nodes {\n              name\n            }\n          }\n          name\n          updatedAt\n          createdAt\n          description\n          id\n        }\n      }\n    }\n  }\n`;\n```\n\nNext, we need to configure apollo in our component script, adding the following\nafter the data() declaration.\n\n```javascript path=src/views/RepoPage/RepoPage.vue\napollo: {\n  organization: REPO_QUERY\n},\n```\n\nAt this point, we should run our query view the raw the results to verify that\nthe request is working.\n\nIn RepoPage.vue add the following before the `RepoTable` tag.\n\n```html path=src/views/RepoPage/RepoPage.vue\n{{ this.organization }}\n```\n\nWhen the data loads you should see the response rendered on your repository\npage. If not, check the console to see if there are any errors and fix.\n\nRevert this last change and continue.\n\nThis data is not quite in the format our `RepoTable` component is expecting so\nwe'll use a computed property to transform it. Computed properties in Vue cache\nand watch their reactive dependencies for us.\n\nRemove the 'rows' constant and its use in the data declaration, and add this\ncomputed property.\n\n```javascript path=src/views/RepoPage/RepoPage.vue\ncomputed: {\n  rows() {\n      if (!this.organization) {\n      return [];\n    } else {\n      return this.organization.repositories.nodes.map(row => ({\n        ...row,\n        key: row.id,\n        stars: row.stargazers.totalCount,\n        issueCount: row.issues.totalCount,\n        createdAt: new Date(row.createdAt).toLocaleDateString(),\n        updatedAt: new Date(row.updatedAt).toLocaleDateString(),\n        links: { url: row.url, homepageUrl: row.homepageUrl }\n      }));\n    }\n  }\n}\n```\n\nAt this point you have a working table but the links column clearly isn't what\nwe want.\n\n### Helper component\n\nThis column in the data table will be a list of repository and home page links,\nso let's create a component called `LinkList`.\n\nAdd the following to create your component:\n\nA template section:\n\n```html path=src/views/RepoPage/LinkList.vue\n<ul class=\"link-list\">\n  <li>\n    <cv-link :href=\"url\">GitHub</cv-link>\n  </li>\n\n  <li v-if=\"homepageUrl\">\n    <span>&nbsp;|&nbsp;</span>\n    <cv-link :href=\"homepageUrl\">Homepage</cv-link>\n  </li>\n</ul>\n```\n\nA script section:\n\n```javascript path=src/views/RepoPage/LinkList.vue\nexport default {\n  name: 'LinkList',\n  props: {\n    url: String,\n    homepageUrl: String,\n  },\n};\n```\n\nAnd a style section:\n\n```scss path=src/views/RepoPage/LinkList.vue\n.link-list {\n  display: flex;\n}\n```\n\nNow let's make use of this component in our `RepoTable` component.\n\nAt the top of the script section import the link list component:\n\n```javascript path=src/views/RepoPage/RepoTable.vue\nimport LinkList from './LinkList';\n```\n\nAnd below the name of the component add:\n\n```javascript path=src/views/RepoPage/RepoTable.vue\n  components: { LinkList },\n```\n\nThen make use of it in our template replacing:\n\n<!-- prettier-ignore-start -->\n```html path=src/views/RepoPage/RepoTable.vue\n<cv-data-table-cell\n  v-for=\"(cell, cellIndex) in row.data\"\n  :key=\"`${cellIndex}`\"\n  >{{cell}}</cv-data-table-cell>\n```\n<!-- prettier-ignore-end -->\n\nwith\n\n<!-- prettier-ignore-start -->\n```html path=src/views/RepoPage/RepoTable.vue\n<cv-data-table-cell v-for=\"(cell, cellIndex) in row.data\" :key=\"`${cellIndex}`\">\n  <template v-if=\"!cell.url\">\n    {{cell}}\n  </template>\n  <link-list v-else :url=\"cell.url\" :homepage-url=\"cell.homepageUrl\" />\n</cv-data-table-cell>\n```\n<!-- prettier-ignore-end -->\n\nHere in order to switch between the standard rendering of a data cell we've\nwrapped our standard `{{cell}}` rendering in a template tag. The template tag is\nnon-rendering so it will disappear, leaving us with the same content as before.\n\nUsing the v-if and v-else directives we switch based on the contents of the cell\nbetween the standard rendering and the LinkList component.\n\nChecking our output again, you should now see the LinkList component rendering\nthe final column.\n\nNext we'll update our row description. Update the computed property data() in\n`RepoTable.vue` to have the following description:\n\n<!-- prettier-ignore-start -->\n```javascript path=src/views/RepoPage/RepoTable.vue\n  description: row.description\n```\n<!-- prettier-ignore-end -->\n\nCheck the output again and you should find the descriptions are updated.\n\nAfter this many refreshes you may have noticed a slight delay in the data\nloading. As outlined in the\n[documentation](https://vue-apollo.netlify.com/guide/apollo/#apollo), all\ncomponents contained under one with an apolloProvider have a `$apollo`\nattribute. As we added the `apolloProvider` to our app when creating the Vue\ninstance it is available to us everywhere.\n\nWe can use the property to react to\n[loading state](https://vue-apollo.netlify.com/guide/apollo/queries.html#loading-state).\n\nFirst let's demonstrate that this works.\n\nPass the loading state into our `RepoTable` component by updating the template\nwith the following:\n\n```html path=src/views/RepoPage/RepoPage.vue\n<repo-table\n  :headers=\"headers\"\n  :rows=\"rows\"\n  title=\"Carbon Repositories\"\n  helperText=\"A collection of public Carbon repositories.\"\n  :loading=\"$apollo.loading\"\n/>\n```\n\nNext add this property to the `RepoTable` component:\n\n```javascript path=src/views/RepoPage/RepoTable.vue\n  props: {\n    headers: Array,\n    rows: Array,\n    title: String,\n    helperText: String,\n    loading: Boolean,\n  },\n```\n\nMaking use of the property to display a loading message.\n\nReplace:\n\n```html path=src/views/RepoPage/RepoTable.vue\n<cv-data-table\n  :columns=\"columns\"\n  :title=\"title\"\n  :helper-text=\"helperText\"\n></cv-data-table>\n```\n\nwith:\n\n```html path=src/views/RepoPage/RepoTable.vue\n<div v-if=\"loading\">Loading...</div>\n<cv-data-table\n  v-else\n  :columns=\"columns\"\n  :title=\"title\"\n  :helper-text=\"helperText\"\n></cv-data-table>\n```\n\nHere we have made use of the v-if and v-else directives to switch content based\non the state of `$apollo.loading`. If you refresh your app you should see this\ntake effect.\n\nNow that we know this is works let's try something a bit more sophisticated and\nreplace the div containing our loading message with use of the\n`CvDataTableSkeleton` component.\n\n<!-- prettier-ignore-start -->\n```html path=src/views/RepoPage/RepoTable.vue\n<cv-data-table-skeleton\n  v-if=\"loading\"\n  :columns=\"columns\"\n  :title=\"title\"\n  :helper-text=\"helperText\"\n  :rows=\"10\"\n/>\n```\n<!-- prettier-ignore-end -->\n\nWe need to tell the loading skeleton how many rows to render, so let's use 10\nskeleton rows to prepare for the next enhancement...\n\n## Add pagination\n\nPagination! Instead of rendering every repository, let's add pagination to the\ndata table to only render 10 at a time. Depending on your specific requirements,\nyou may need to fetch new data each time that you interact with the pagination\ncomponent, but for simplicity, we're going to make one request to fetch all\ndata, and then paginate the in-memory row data.\n\nLet's start by adjusting our `PageTable` component template to add pagination.\nIf you review the\n[storybook notes](http://vue.carbondesignsystem.com/?path=/info/components-cvdatatable--default)\nyou'll see that pagination is added to the data table by supplying a pagination\nobject and listening for pagination events as follows.\n\n<!-- prettier-ignore-start -->\n```html path=src/views/RepoPage/RepoTable.vue\n  <cv-data-table\n    v-else\n    :columns=\"columns\"\n    :title=\"title\"\n    :helper-text=\"helperText\"\n    :pagination=\"{ numberOfItems: this.totalRows }\"\n    @pagination=\"$emit('pagination', $event)\"\n>\n```\n<!-- prettier-ignore-end -->\n\n<InlineNotification>\n\n**Note:** `:prop` is an abbreviation of `v-bind:prop`. `@event` is an\nabbreviation of `v-on:event`.\n\n</InlineNotification>\n\nIn the pagination event we've used $emit and $event to re-raise the pagination\nevent to our `RepoPage` component so that it can arrange to pass only the rows\nwe want to see to the `RepoTable` component.\n\nWe also need to add the `totalRows` property used in the data tables pagination\nproperty.\n\n```javascript path=src/views/RepoPage/RepoTable.vue\ntotalRows: Number,\n```\n\nNext to our `RepoPage` component, let's first update our template by updating\nour `RepoTable` use with the following attributes.\n\n<!-- prettier-ignore-start -->\n```html path=src/views/RepoPage/RepoPage.vue\n:rows=\"pagedRows\"\n:totalRows=\"rows.length\"\n@pagination=\"onPagination\"\n```\n<!-- prettier-ignore-end -->\n\nreplacing\n\n```html path=src/views/RepoPage/RepoPage.vue\n:rows=\"rows\"\n```\n\nNext in the data property of our component add values for `pageSize`,\n`pageStart` and `page` into the data method return to support our pagination.\n\n```javascript path=src/views/RepoPage/RepoPage.vue\n  data() {\n    return {\n      headers,\n      pageSize: 0,\n      pageStart: 0,\n      page: 0\n    };\n  },\n```\n\n<InlineNotification>\n\n**Note:** We could have passed values for `pageSize` and `page` into our\npagination component if we had a specific page or page size we wanted to start\nwith. Instead we are relying on the pagination component to set some sensible\ndefaults and provide us with the details through an event.\n\n</InlineNotification>\n\nThen before we can see our paginated table we need to add: a `pagedRows`\ncomputed property to select the slice of input rows we are interested in, and a\nmethod to handle the pagination event.\n\n```javascript path=src/views/RepoPage/RepoPage.vue\n  computed: {\n    // other computed properties\n    // ...\n    pagedRows() {\n      return this.rows.slice(this.pageStart, this.pageStart + this.pageSize);\n    }\n  },\n  methods: {\n    onPagination(val) {\n      this.pageSize = val.length;\n      this.pageStart = val.start;\n      this.page = val.page;\n    }\n  }\n```\n\n<InlineNotification>\n\n**Note:** Like the other Carbon Vue components, `Pagination` component examples\ncan be found in\n[Storybook](http://vue.carbondesignsystem.com/?path=/story/components-cvpagination--default)\nby browsing the story and knobs.\n\n</InlineNotification>\n\nThat does it! Your data table should fetch GitHub data on first render. You can\nexpand each row to see the repository's description. You can modify the\npagination items per page and cycle through pages or jump to a specific page of\nrepositories.\n\n## Mystery\n\nHmmm, there is at least one more issue to resolve. If you expand a row or two to\nsee the repository descriptions you will and then change page. What happens?\n\nAssuming you didn't catch this earlier you will find that the expanded rows,\nstay expanded after paging. That is if row two was expanded before pagination it\nis expanded after.\n\nThis is because we chose poor values to use as our row and cell keys as we\niterated over them. The result is that Vue sees these items as having the same\nkey and makes the assumption that content but not state has changed.\n\nTo fix this add the following to the RepoPage component you should be able to\nfind something better.\n\n```javascript\n  watch: {\n    rows() {\n      if (this.organization) {\n        console.dir(this.organization.repositories.nodes);\n      }\n    }\n  },\n```\n\n_Hint: `id` and `url` are likely unique properties, you could use either of\nthese to update the prototype. In fact we already pass the id value to\nRepoTable._\n\nCan you fix it?\n\n## Submit pull request\n\nWe're going to submit a pull request to verify completion of this tutorial step.\n\n### Continuous integration (CI) check\n\nRun the CI check to make sure we're all set to submit a pull request.\n\n```bash\nyarn ci-check\n```\n\n<InlineNotification>\n\n**Note:** Having issues running the CI check?\n[Step 1](/developing/vue-tutorial/step-1#continuous-integration-ci-check) has\ntroubleshooting notes that may help.\n\n</InlineNotification>\n\n### Git commit and push\n\nBefore we can create a pull request, stage and commit all of your changes:\n\n```bash\ngit add --all && git commit -m \"feat(tutorial): complete step 3\"\n```\n\nThen, push to your repository:\n\n```bash\ngit push origin vue-step-3\n```\n\n<InlineNotification>\n\n**Note:** Having issues pushing your changes?\n[Step 1](/developing/vue-tutorial/step-1#git-commit-and-push) has\ntroubleshooting notes that may help.\n\n</InlineNotification>\n\n### Pull request (PR)\n\nFinally, visit\n[carbon-tutorial-vue](https://github.com/carbon-design-system/carbon-tutorial-vue)\nto \"Compare & pull request\". In doing so, make sure that you are comparing to\n`vue-step-3` into `base: vue-step-3`.\n\n<InlineNotification>\n\n**Note:** Expect your tutorial step PRs to be reviewed by the Carbon team but\nnot merged. We'll close your PR so we can keep the repository's remote branches\npristine and ready for the next person!\n\n</InlineNotification>\n","fileAbsolutePath":"/home/runner/work/carbon-website/carbon-website/src/pages/developing/vue-tutorial/step-3.mdx"}}},
    "staticQueryHashes": ["1364590287","137577622","2102389209","2456312558","2746626797","3018647132","3037994772","338751667","768070550"]}